for (i in 1:ng) {
Wt[[i]] = X[[i]] %*% t(X[[i]])
}
Wt
rownames(P)=StudyNames
colnames(P)=StudyNames
#RV: correlations among the occasions
RV = solve(diag(sqrt(diag(P)))) %*% P %*% solve(diag(sqrt(diag(P))))
P
# Calculation of the scalar products
P = matrix(0, ng, ng)
for (i in 1:ng) for (j in 1:ng) {
P[i, j] = sum(diag(Wt[[i]] %*% t(Wt[[j]])))
P[j, i] = P[i, j]
}
rownames(P)=StudyNames
colnames(P)=StudyNames
P
#RV: correlations among the occasions
RV = solve(diag(sqrt(diag(P)))) %*% P %*% solve(diag(sqrt(diag(P))))
rownames(RV)=StudyNames
colnames(RV)=StudyNames
RV
# This information will be common to all the techniques, then a single
# function to plot is necassary
StatisRes$Data = X
StatisRes$Objects = Wt
StatisRes$ScalarProducts = P
StatisRes$RV = RV
Inter = svd(RV)
StatisRes$EigInter = Inter$d
names(StatisRes$EigInter)=paste("Dim",1:length(StudyNames))
StatisRes$InerInter=(Inter$d/sum(Inter$d))*100
names(StatisRes$InerInter)=paste("Dim",1:length(StudyNames))
StatisRes$InterStructure = -1 * Inter$u %*% diag(sqrt(Inter$d))
rownames(StatisRes$InterStructure)=StudyNames
colnames(StatisRes$InterStructure)=paste("Dim", 1:ng)
# Weigths for the Compromise
StatisRes$Weights = abs(Inter$u[, 1])/sum(abs(Inter$u[, 1]))
# Compromise
W=matrix(0,nr,nr)
for (i in 1:ng)
W=W + StatisRes$Weights[i]*Wt[[i]]
StatisRes$Compromise=W
# Euclidean Configuration of the compromise
Intra = svd(W)
r=sum(Intra$d>0.00001)
BiplotStatis$EigenValues=Intra$d[1:r]
BiplotStatis$Inertia=(Intra$d[1:r]/sum(diag(Intra$d[1:r])))*100
BiplotStatis$CumInertia = cumsum(BiplotStatis$Inertia)
BiplotStatis$alpha=1
BiplotStatis$Dimension=dimens
# Compromise-Consensus Coordinates and contributions
BiplotStatis$RowCoordinates = Intra$u[,1:dimens] %*% diag(sqrt(Intra$d[1:dimens]))
sf=apply((Intra$u[,1:r] %*% diag(sqrt(Intra$d[1:r])))^2,1,sum)
BiplotStatis$RowContributions=(diag(1/sf) %*% BiplotStatis$RowCoordinates^2)*100
rownames(BiplotStatis$RowCoordinates)=rownames(X[[1]])
colnames(BiplotStatis$RowCoordinates)=paste("Dim", 1:dimens)
rownames(BiplotStatis$RowContributions)=rownames(X[[1]])
colnames(BiplotStatis$RowContributions)=paste("Dim", 1:dimens)
# Trajectories for individuals (old kind)
trajin=list()
for (j in 1:ng)
trajin[[j]] = Wt[[j]] %*% Intra$u[,1:r] %*% diag(sqrt(1/Intra$d[1:r]))
StatisRes$TrajInd=list()
for (i in 1:nr){
Traj=NULL
for (j in 1:ng)
Traj=rbind(Traj , trajin[[j]][i,1:dimens])
rownames(Traj)=StudyNames
colnames(Traj)=paste("Dim", 1:dimens)
StatisRes$TrajInd[[i]]=Traj
}
names(StatisRes$TrajInd)=rownames(X[[1]])
# Squared cosines of the individual objects projected onto the compromise
contbt=list()
for (j in 1:ng){
sf=apply(trajin[[j]]^2,1,sum)
contbt[[j]] = (diag(1/sf) %*% trajin[[j]]^2)*100
}
StatisRes$ContribInd=list()
for (i in 1:nr){
Traj=NULL
for (j in 1:ng)
Traj=rbind(Traj , contbt[[j]][i,1:dimens])
rownames(Traj)=StudyNames
colnames(Traj)=paste("Dim", 1:dimens)
StatisRes$ContribInd[[i]]=Traj
}
names(StatisRes$ContribInd)=rownames(X[[1]])
# Coordinates and contributions of the variables on the biplot
# First we calculate the principal coordinates in order to calculate the contributions
trajvar=list()
for (j in 1:ng)
trajvar[[j]]=t(X[[j]]) %*% Intra$u[,1:r]
# Coordinates of the variables on the biplot
contvar=list()
for (j in 1:ng){
sf=apply(trajvar[[j]]^2,1,sum)
contvar[[j]] = (diag(1/sf) %*% trajvar[[j]]^2)*100
rownames(contvar[[j]])=paste(colnames(X[[j]]), "-", StudyNames[j], sep="")
}
# Standard coodinates to represent on the biplot (RMP-Biplot)
# Standard coordinates are needed to represent the biplot axes with graded scales
for (j in 1:ng){
trajvar[[j]]=t(X[[j]]) %*% Intra$u[,1:r] %*% diag(1/Intra$d[1:r])
rownames(trajvar[[j]])=paste(rownames(trajvar[[j]]), "-", StudyNames[j], sep="")
}
BiplotStatis$ColCoordinates=NULL
for (j in 1:ng)
BiplotStatis$ColCoordinates=rbind(BiplotStatis$ColCoordinates, trajvar[[j]][,1:dimens])
colnames(BiplotStatis$ColCoordinates)<- paste("Dim ",1:dimens)
BiplotStatis$ColContributions=NULL
for (j in 1:ng)
BiplotStatis$ColContributions=rbind(BiplotStatis$ColContributions, contvar[[j]][,1:dimens])
colnames(BiplotStatis$ColContributions)<- paste("Dim ",1:dimens)
sca = sum(BiplotStatis$RowCoordinates^2)
scb = sum(BiplotStatis$ColCoordinates^2)
p=sum(nci)
sca = sca/nr
scb = scb/p
scf = sqrt(sqrt(scb/sca))
BiplotStatis$RowCoordinates = BiplotStatis$RowCoordinates * scf
BiplotStatis$ColCoordinates = BiplotStatis$ColCoordinates/scf
BiplotStatis$Scale_Factor=scf
for (i in 1:nr){
StatisRes$TrajInd[[i]]=StatisRes$TrajInd[[i]]*scf
}
BiplotStatis$ClusterType="us"
BiplotStatis$Clusters = as.factor(matrix(1,nrow(BiplotStatis$RowContributions), 1))
BiplotStatis$ClusterColors="blue"
BiplotStatis$ClusterNames="Cluster 1"
class(BiplotStatis) ="ContinuousBiplot"
# If the variables are the same for all the occasions or studies
# additional trajectories for the variables can be constructed
# selecting conveniently the var coordinates. This are original
# in our work, together with the simultaneous representation
# of rows and columns.
StatisRes$Biplot=BiplotStatis
StatisRes$SameIndiv = TRUE
StatisRes$SameVar = SameVar
if (SameVar){
p=nci[1]
StatisRes$TrajVar=list()
for (i in 1:p){
Traj=NULL
for (j in 1:ng)
Traj=rbind(Traj , trajvar[[j]][i,1:dimens])
rownames(Traj)=StudyNames
colnames(Traj)=paste("Dim", 1:dimens)
StatisRes$TrajVar[[i]]=Traj}
names(StatisRes$TrajVar)=colnames(X[[1]])
}
# Calculation of the Inertia of each study (or occasion) accounted for the STATIS solution.
# Comparing this with the inertia accounted by the biplot for each separate study
# we have an index of the goodness of the consensus (or compromise) in explaining the
# study.
StatisRes$Biplot$Structure = cor(StatisRes$Biplot$Non_Scaled_Data, StatisRes$Biplot$RowCoordinates)
class(StatisRes) = "StatisBiplot"
return(StatisRes)
library(MultBiplotR)
data(Chemical)
# Extract continous data from the original data frame.
x= Chemical[,5:16]
# Obtaining the three way table as a list
X=Convert2ThreeWay(x,Chemical$WEEKS, columns=FALSE)
# Calculating the Biplot associated to STATIS-ACT
stbip=StatisBiplot(X, SameVar=TRUE)
# Basic plot of the results
plot(stbip)
# Colors By Table
plot(stbip, VarColorType="ByTable")
# Colors By Variable
plot(stbip, VarColorType="ByVar", mode="s",  MinQualityVars = 0.5)
plot(stbip, PlotRowTraj = TRUE, PlotVars=FALSE, RowColors=1:36)
plot(stbip, PlotRowTraj = F, PlotVars=FALSE, RowColors=1:36)
# Basic plot of the results
plot(stbip,PlotType="Correlations")
plot(stbip,PlotType="Contributions")
stbip$TrajInd
stbip
names(stbip)
stbip$InterStructure
help(CorrelationCircle)
source('~/Library/Mobile Documents/com~apple~CloudDocs/# # 0 ProgramasR/0 Paquetes/MultBiplotR/R/plot.StatisBiplot.R')
# Basic plot of the results
plot(stbip,PlotType="Correlations", VarColorType=="ByTable")
# Basic plot of the results
plot(stbip,PlotType="Correlations", VarColorType="ByVar")
Chemical
# Extract continous data from the original data frame.
x= Chemical[,5:16]
x
# Extract continous data from the original data frame.
x= Chemical[,5:11]
# Obtaining the three way table as a list
X=Convert2ThreeWay(x,Chemical$WEEKS, columns=FALSE)
X
X=X[[1:4]]
# Calculating the Biplot associated to STATIS-ACT
stbip=StatisBiplot(X, SameVar=TRUE)
stbip$TrajInd
X
X=X[1:4]
X
# Calculating the Biplot associated to STATIS-ACT
stbip=StatisBiplot(X, SameVar=TRUE)
stbip$TrajInd
# Basic plot of the results
plot(stbip,PlotType="Correlations", VarColorType="ByVar")
X
# Basic plot of the results
plot(stbip,PlotType="Correlations", VarColorType="ByTable")
source('~/Library/Mobile Documents/com~apple~CloudDocs/# # 0 ProgramasR/0 Paquetes/MultBiplotR/R/plot.StatisBiplot.R')
# Basic plot of the results
plot(stbip,PlotType="Correlations", VarColorType="ByTable")
plot(stbip,PlotType="Contributions", VarColorType="ByVar")
ColContributionPlot(x$Biplot, Colors=ColorVar, Labs=VarLabels, cex=0.7, MinQuality = 0.7, AddSigns2Labs=FALSE)
source('~/Library/Mobile Documents/com~apple~CloudDocs/# # 0 ProgramasR/0 Paquetes/MultBiplotR/R/plot.StatisBiplot.R')
plot(stbip,PlotType="Contributions", VarColorType="ByVar")
plot(stbip,PlotType="Contributions", VarColorType="ByTable")
source('~/Library/Mobile Documents/com~apple~CloudDocs/# # 0 ProgramasR/0 Paquetes/MultBiplotR/R/plot.StatisBiplot.R')
source('~/Library/Mobile Documents/com~apple~CloudDocs/# # 0 ProgramasR/0 Paquetes/MultBiplotR/R/plot.StatisBiplot.R')
plot(stbip,PlotType="Contributions", VarColorType="ByTable")
plot(stbip,PlotType="Contributions", VarColorType="ByVar")
source('~/Library/Mobile Documents/com~apple~CloudDocs/# # 0 ProgramasR/0 Paquetes/MultBiplotR/R/ColContributionPlot.R')
plot(stbip,PlotType="Contributions", VarColorType="ByVar")
plot(stbip,PlotType="Contributions", VarColorType="ByVar", CorrelationScale=TRUE)
source('~/Library/Mobile Documents/com~apple~CloudDocs/# # 0 ProgramasR/0 Paquetes/MultBiplotR/R/ColContributionPlot.R')
plot(stbip,PlotType="Contributions", VarColorType="ByVar", CorrelationScale=TRUE)
# Colors By Table
plot(stbip, VarColorType="ByTable")
plot(stbip,PlotType="Contributions", VarColorType="ByVar", CorrelationScale=TRUE)
# Colors By Table
plot(stbip, VarColorType="ByTable")
# Colors By Variable
plot(stbip, VarColorType="ByVar", mode="s",  MinQualityVars = 0.5)
plot(stbip, PlotRowTraj = F, PlotVars=FALSE, RowColors=1:36)
plot(stbip, PlotRowTraj = F, PlotVars=FALSE)
plot(stbip, PlotRowTraj = T, PlotVars=FALSE)
plot(stbip, PlotRowTraj = TRUE, PlotVars=FALSE)
plot(stbip, PlotRowTraj = T, PlotVars=FALSE, RowColors=1:36)
RowColors
if (is.null(RowColors)) RowColors=rep("black", nind)
source('~/Library/Mobile Documents/com~apple~CloudDocs/# # 0 ProgramasR/0 Paquetes/MultBiplotR/R/plot.StatisBiplot.R')
plot(stbip, PlotRowTraj = T, PlotVars=FALSE)
stbip$TrajInd
stbip$TrajVar
length()
source('~/Library/Mobile Documents/com~apple~CloudDocs/# # 0 ProgramasR/0 Paquetes/MultBiplotR/R/plot.StatisBiplot.R')
ntraj=length(x$TrajInd)
ntraj
source('~/Library/Mobile Documents/com~apple~CloudDocs/# # 0 ProgramasR/0 Paquetes/MultBiplotR/R/plot.StatisBiplot.R')
source('~/Library/Mobile Documents/com~apple~CloudDocs/# # 0 ProgramasR/0 Paquetes/MultBiplotR/R/plot.StatisBiplot.R')
plot(stbip, PlotRowTraj = T, PlotVars=FALSE, LabelTraj=='End')
plot(stbip, PlotRowTraj = T, PlotVars=FALSE, LabelTraj='Begining')
plot(stbip, PlotRowTraj = T, PlotVars=FALSE, LabelTraj='End')
source('~/Library/Mobile Documents/com~apple~CloudDocs/# # 0 ProgramasR/0 Paquetes/MultBiplotR/R/plot.StatisBiplot.R')
plot(stbip, PlotRowTraj = T, PlotVars=FALSE, LabelTraj='End')
stbip$TrajInd
names(stbip)
source('~/Library/Mobile Documents/com~apple~CloudDocs/# # 0 ProgramasR/0 Paquetes/MultBiplotR/R/plot.StatisBiplot.R')
source('~/Library/Mobile Documents/com~apple~CloudDocs/# # 0 ProgramasR/0 Paquetes/MultBiplotR/R/plot.StatisBiplot.R')
source('~/Library/Mobile Documents/com~apple~CloudDocs/# # 0 ProgramasR/0 Paquetes/MultBiplotR/R/plot.StatisBiplot.R')
plot(stbip, PlotRowTraj = T, PlotVars=FALSE, LabelTraj='End')
stbip$TrajInd
names(stbip$TrajInd)
x=stbip
r2
source('~/Library/Mobile Documents/com~apple~CloudDocs/# # 0 ProgramasR/0 Paquetes/MultBiplotR/R/plot.StatisBiplot.R')
x$TrajInd
Traj=x$TrajInd
ntraj=length(Traj)
ntraj
TrajNames=names(Traj)
TrajNames
plot(new)
PlotTrajectory <- function(Traj, Centers=NULL, TypeTraj="line"){
ntraj=length(Traj)
TrajNames=names(Traj)
for (i in 1:ntraj))
points(x$TrajInd[[i]][,A1], x$TrajInd[[i]][,A2], type="l", col=RowColors[i])
if (LabelTraj=='Begining') text(x$TrajInd[[i]][1,A1], x$TrajInd[[i]][1,A2], label=TrajNames[i], col=RowColors[i])
if (LabelTraj=='End') text(x$TrajInd[[i]][noc,A1], x$TrajInd[[i]][noc,A2], label=TrajNames[i], col=RowColors[i])
}
Centers=NULL
TypeTraj="line"
help("segments")
source('~/Library/Mobile Documents/com~apple~CloudDocs/# # 0 ProgramasR/0 Paquetes/MultBiplotR/R/PlotTrajectory.R')
plot(x$Biplot, A1=A1, A2=A2, ColorVar=ColorVar, VarLabels=VarLabels, ColorInd=RowColors, ...)
plot(x$Biplot, A1=A1, A2=A2, ColorVar=ColorVar, VarLabels=VarLabels, ColorInd=RowColors)
A1 = 1
plot(stbip, PlotRowTraj = F, PlotVars=FALSE, LabelTraj='End')
plot(stbip, PlotRowTraj = F, PlotVars=FALSE, LabelTraj='End', RowColors=1:36)
RowColors=1:36
PlotTrajectory(x$TrajInd)
source('~/Library/Mobile Documents/com~apple~CloudDocs/# # 0 ProgramasR/0 Paquetes/MultBiplotR/R/PlotTrajectory.R')
PlotTrajectory(x$TrajInd)
plot(stbip, PlotRowTraj = F, PlotVars=FALSE, LabelTraj='End', RowColors=1:36)
PlotTrajectory(x$TrajInd)
RowColors
source('~/Library/Mobile Documents/com~apple~CloudDocs/# # 0 ProgramasR/0 Paquetes/MultBiplotR/R/PlotTrajectory.R')
source('~/Library/Mobile Documents/com~apple~CloudDocs/# # 0 ProgramasR/0 Paquetes/MultBiplotR/R/PlotTrajectory.R')
RowColors
PlotTrajectory(x$TrajInd)
source('~/Library/Mobile Documents/com~apple~CloudDocs/# # 0 ProgramasR/0 Paquetes/MultBiplotR/R/PlotTrajectory.R')
PlotTrajectory(x$TrajInd)
PlotTrajectory(x$TrajInd, TypeTraj="star")
names(stbip)
x$Compromise
x$Biplot$RowCoordinates
PlotTrajectory(x$TrajInd, Centers=x$Biplot$RowCoordinates, TypeTraj="star")
plot(stbip, PlotRowTraj = F, PlotVars=FALSE, LabelTraj='End', RowColors=1:36)
PlotTrajectory(x$TrajInd, Centers=x$Biplot$RowCoordinates, TypeTraj="star")
PlotTrajectory(x$TrajInd, Centers=x$Biplot$RowCoordinates, TypeTraj="star", ColorTraj=RowColors)
source('~/Library/Mobile Documents/com~apple~CloudDocs/# # 0 ProgramasR/0 Paquetes/MultBiplotR/R/PlotTrajectory.R')
PlotTrajectory(x$TrajInd, Centers=x$Biplot$RowCoordinates, TypeTraj="star", ColorTraj=RowColors)
nind=dim(Traj[[1]])[1]
source('~/Library/Mobile Documents/com~apple~CloudDocs/# # 0 ProgramasR/0 Paquetes/MultBiplotR/R/PlotTrajectory.R')
PlotTrajectory(x$TrajInd, Centers=x$Biplot$RowCoordinates, TypeTraj="star", ColorTraj=RowColors)
source('~/Library/Mobile Documents/com~apple~CloudDocs/# # 0 ProgramasR/0 Paquetes/MultBiplotR/R/plot.StatisBiplot.R')
source('~/Library/Mobile Documents/com~apple~CloudDocs/# # 0 ProgramasR/0 Paquetes/MultBiplotR/R/plot.StatisBiplot.R')
plot(stbip, PlotRowTraj = F, PlotVars=FALSE, LabelTraj='End', RowColors=1:36, PlotVarTraj=TRUE)
x$TrajVar
print(VarColors)
source('~/Library/Mobile Documents/com~apple~CloudDocs/# # 0 ProgramasR/0 Paquetes/MultBiplotR/R/plot.StatisBiplot.R')
plot(stbip, PlotRowTraj = F, PlotVars=FALSE, LabelTraj='End', RowColors=1:36, PlotVarTraj=TRUE)
source('~/Library/Mobile Documents/com~apple~CloudDocs/# # 0 ProgramasR/0 Paquetes/MultBiplotR/R/plot.StatisBiplot.R')
plot(stbip, PlotRowTraj = F, PlotVars=FALSE, LabelTraj='End', RowColors=1:36, PlotVarTraj=TRUE)
source('~/Library/Mobile Documents/com~apple~CloudDocs/# # 0 ProgramasR/0 Paquetes/MultBiplotR/R/PlotTrajectory.R')
plot(stbip, PlotRowTraj = F, PlotVars=FALSE, LabelTraj='End', RowColors=1:36, PlotVarTraj=TRUE)
plot(stbip, PlotRowTraj = F, PlotVars=T, LabelTraj='End', RowColors=1:36, PlotVarTraj=TRUE)
source('~/Library/Mobile Documents/com~apple~CloudDocs/# # 0 ProgramasR/0 Paquetes/MultBiplotR/R/plot.StatisBiplot.R')
source('~/Library/Mobile Documents/com~apple~CloudDocs/# # 0 ProgramasR/0 Paquetes/MultBiplotR/R/plot.StatisBiplot.R')
plot(stbip, PlotRowTraj = F, PlotVars=T, LabelTraj='End', RowColors=1:36, PlotVarTraj=TRUE, VarColorType="ByVar")
x$Biplot$Scale_Factor
source('~/Library/Mobile Documents/com~apple~CloudDocs/# # 0 ProgramasR/0 Paquetes/MultBiplotR/R/StatisBiplot.R')
# Calculating the Biplot associated to STATIS-ACT
stbip=StatisBiplot(X, SameVar=TRUE)
plot(stbip, PlotRowTraj = F, PlotVars=T, LabelTraj='End', RowColors=1:36, PlotVarTraj=TRUE, VarColorType="ByVar")
plot(stbip, PlotRowTraj = F, PlotVars=F, LabelTraj='End', RowColors=1:36, PlotVarTraj=TRUE, VarColorType="ByVar")
# Extract continous data from the original data frame.
x= Chemical[,5:16]
# Obtaining the three way table as a list
X=Convert2ThreeWay(x,Chemical$WEEKS, columns=FALSE)
X=X[1:4]
data(Chemical)
# Extract continous data from the original data frame.
x= Chemical[,5:11]
# Obtaining the three way table as a list
X=Convert2ThreeWay(x,Chemical$WEEKS, columns=FALSE)
X=X[1:6]
# Calculating the Biplot associated to STATIS-ACT
stbip=StatisBiplot(X, SameVar=TRUE)
plot(stbip, PlotRowTraj = F, PlotVars=F, LabelTraj='End', RowColors=1:36, PlotVarTraj=TRUE, VarColorType="ByVar")
plot(stbip, PlotRowTraj = F, PlotVars=F, LabelTraj='End', RowColors=1:36, PlotVarTraj=TRUE, VarColorType="ByVar")
source('~/Library/Mobile Documents/com~apple~CloudDocs/# # 0 ProgramasR/0 Paquetes/MultBiplotR/R/PlotTrajectory.R')
source('~/Library/Mobile Documents/com~apple~CloudDocs/# # 0 ProgramasR/0 Paquetes/MultBiplotR/R/PlotTrajectory.R')
source('~/Library/Mobile Documents/com~apple~CloudDocs/# # 0 ProgramasR/0 Paquetes/MultBiplotR/R/plot.StatisBiplot.R')
plot(stbip, PlotRowTraj = F, PlotVars=F, LabelTraj='End', RowColors=1:36, PlotVarTraj=TRUE, VarColorType="ByVar")
plot(stbip, PlotRowTraj = F, PlotVars=F, LabelTraj='End',PlotVarTraj=TRUE, VarColorType="ByVar")
source('~/Library/Mobile Documents/com~apple~CloudDocs/# # 0 ProgramasR/0 Paquetes/MultBiplotR/R/PlotTrajectory.R')
plot(stbip, PlotRowTraj = F, PlotVars=F, LabelTraj='End',PlotVarTraj=TRUE, VarColorType="ByVar")
plot(stbip, PlotRowTraj = F, PlotVars=F, LabelTraj='Begining',PlotVarTraj=TRUE, VarColorType="ByVar")
# Obtaining the three way table as a list
X=Convert2ThreeWay(x,Chemical$WEEKS, columns=FALSE)
X=X[2:6]
# Calculating the Biplot associated to STATIS-ACT
stbip=StatisBiplot(X, SameVar=TRUE)
plot(stbip, PlotRowTraj = F, PlotVars=F, LabelTraj='Begining',PlotVarTraj=TRUE, VarColorType="ByVar")
X
dim(x)
data(Chemical)
dim(Chemical)
# Extract continous data from the original data frame.
x= Chemical[,5:16]
# Obtaining the three way table as a list
X=Convert2ThreeWay(x,Chemical$WEEKS, columns=FALSE)
X
X=X[3:9]
# Calculating the Biplot associated to STATIS-ACT
stbip=StatisBiplot(X, SameVar=TRUE)
# Basic plot of the results
plot(stbip,PlotType="Correlations", VarColorType="ByTable")
plot(stbip,PlotType="Contributions", VarColorType="ByVar", CorrelationScale=TRUE)
# Colors By Table
plot(stbip, VarColorType="ByTable")
# Colors By Variable
plot(stbip, VarColorType="ByVar", mode="s",  MinQualityVars = 0.5)
plot(stbip, PlotRowTraj = F, PlotVars=F, LabelTraj='Begining',PlotVarTraj=TRUE, VarColorType="ByVar")
plot(stbip, PlotRowTraj = T, PlotVars=F, LabelTraj='Begining',PlotVarTraj=F, VarColorType="ByVar")
X
x
x
data(Chemical)
Chemical
# Obtaining the three way table as a list
X=Convert2ThreeWay(x,Chemical$WEEKS, columns=FALSE, RowNames=Chemical$Treatment)
X
readxl::read_excel("/Users/villardon/Library/Mobile Documents/com~apple~CloudDocs/# # 0 Clases_master/0 STATIS-ACT/OCDE/DatosOCDE.xlsx")
datos=readxl::read_excel("/Users/villardon/Library/Mobile Documents/com~apple~CloudDocs/# # 0 Clases_master/0 STATIS-ACT/OCDE/DatosOCDE.xlsx")
library(readxl)
datos=readxl::read_excel("/Users/villardon/Library/Mobile Documents/com~apple~CloudDocs/# # 0 Clases_master/0 STATIS-ACT/OCDE/DatosOCDE.xlsx")
datos$Ocasion=factor(datos$Ocasion)
datos$Pais=factor(datos$pais)
datos$Pais=factor(datos$Pais)
datos
dim(Datos)
dim(datos)
# Extract continous data from the original data frame.
x= datos[,3:12]
x
# Obtaining the three way table as a list
X=Convert2ThreeWay(x,datos$Ocasion, columns=FALSE, RowNames=datos$Pais)
X
# Calculating the Biplot associated to STATIS-ACT
stbip=StatisBiplot(X, SameVar=TRUE)
# Basic plot of the results
plot(stbip,PlotType="Correlations", VarColorType="ByTable")
plot(stbip,PlotType="Contributions", VarColorType="ByVar", CorrelationScale=TRUE)
# Colors By Table
plot(stbip, VarColorType="ByTable")
# Colors By Variable
plot(stbip, VarColorType="ByVar", mode="s",  MinQualityVars = 0.5)
plot(stbip, PlotRowTraj = T, PlotVars=F, LabelTraj='Begining',PlotVarTraj=F, VarColorType="ByVar")
plot(stbip, PlotRowTraj = F, PlotVars=F, LabelTraj='Begining',PlotVarTraj=T, VarColorType="ByVar")
plot(stbip, PlotRowTraj = T, PlotVars=F, LabelTraj='Begining',PlotVarTraj=F, VarColorType="ByVar", RowRandomColors=TRUE)
plot(stbip, PlotRowTraj = T, PlotVars=F, LabelTraj='Begining',PlotVarTraj=F, VarColorType="ByVar", RowRandomColors=TRUE)
plot(stbip, PlotRowTraj = F, PlotVars=F, LabelTraj='Begining',PlotVarTraj=T, VarColorType="ByVar")
stbip$InterStructure
plot(stbip$InterStructure[,1],stbip$InterStructure[,2])
plot(stbip$InterStructure[,1],stbip$InterStructure[,2], xlin=(0,1))
plot(stbip$InterStructure[,1],stbip$InterStructure[,2], xlim=(0,1))
plot(stbip$InterStructure[,1],stbip$InterStructure[,2], xlim=c(0,1))
plot(stbip$InterStructure[,1],stbip$InterStructure[,2], xlim=c(0,1), asp=1)
arrows(0,0, stbip$InterStructure[,1],stbip$InterStructure[,2], xlim=c(0,1), asp=1)
plot.new()
arrows(0,0, stbip$InterStructure[,1],stbip$InterStructure[,2], xlim=c(0,1), asp=1)
plot(stbip$InterStructure[,1],stbip$InterStructure[,2], xlim=c(0,1), asp=1, cex=0.1)
arrows(0,0, stbip$InterStructure[,1],stbip$InterStructure[,2], xlim=c(0,1), asp=1)
plot(stbip$InterStructure[,1],stbip$InterStructure[,2], xlim=c(0,1.2), asp=1, cex=0.1)
arrows(0,0, stbip$InterStructure[,1],stbip$InterStructure[,2])
source('~/Library/Mobile Documents/com~apple~CloudDocs/# # 0 ProgramasR/0 Paquetes/MultBiplotR/R/plot.StatisBiplot.R')
stbip$TableLabels
x=stbip
x$TableLabels
source('~/Library/Mobile Documents/com~apple~CloudDocs/# # 0 ProgramasR/0 Paquetes/MultBiplotR/R/plot.StatisBiplot.R')
source('~/Library/Mobile Documents/com~apple~CloudDocs/# # 0 ProgramasR/0 Paquetes/MultBiplotR/R/plot.StatisBiplot.R')
plot(stbip,PlotType="InterStructure")
source('~/Library/Mobile Documents/com~apple~CloudDocs/# # 0 ProgramasR/0 Paquetes/MultBiplotR/R/plot.StatisBiplot.R')
source('~/Library/Mobile Documents/com~apple~CloudDocs/# # 0 ProgramasR/0 Paquetes/MultBiplotR/R/plot.StatisBiplot.R')
plot(stbip,PlotType="InterStructure")
# Colors By Table
plot(stbip, VarColorType="ByTable")
text(stbip$InterStructure[,1],stbip$InterStructure[,2],labels = x$TableLabels, pos=3)
plot(stbip$InterStructure[,1],stbip$InterStructure[,2], xlim=c(0,1.2), asp=1, cex=0.1)
arrows(0,0, stbip$InterStructure[,1],stbip$InterStructure[,2])
text(stbip$InterStructure[,1],stbip$InterStructure[,2],labels = x$TableLabels, pos=3)
text(stbip$InterStructure[,1],stbip$InterStructure[,2],labels = x$TableLabels, pos=4)
text(stbip$InterStructure[,1],stbip$InterStructure[,2],labels = x$TableLabels, pos=4, col==1:x$NTables)
source('~/Library/Mobile Documents/com~apple~CloudDocs/# # 0 ProgramasR/0 Paquetes/MultBiplotR/R/plot.StatisBiplot.R')
plot(stbip,PlotType="InterStructure")
text(stbip$InterStructure[,1],stbip$InterStructure[,2],labels = x$TableLabels, pos=4, col=1:x$NTables)
source('~/Library/Mobile Documents/com~apple~CloudDocs/# # 0 ProgramasR/0 Paquetes/MultBiplotR/R/plot.StatisBiplot.R')
source('~/Library/Mobile Documents/com~apple~CloudDocs/# # 0 ProgramasR/0 Paquetes/MultBiplotR/R/plot.StatisBiplot.R')
source('~/Library/Mobile Documents/com~apple~CloudDocs/# # 0 ProgramasR/0 Paquetes/MultBiplotR/R/plot.StatisBiplot.R')
source('~/Library/Mobile Documents/com~apple~CloudDocs/# # 0 ProgramasR/0 Paquetes/MultBiplotR/R/plot.StatisBiplot.R')
source('~/Library/Mobile Documents/com~apple~CloudDocs/# # 0 ProgramasR/0 Paquetes/MultBiplotR/R/plot.StatisBiplot.R')
plot(stbip,PlotType="InterStructure")
source('~/Library/Mobile Documents/com~apple~CloudDocs/# # 0 ProgramasR/0 Paquetes/MultBiplotR/R/plot.StatisBiplot.R')
plot(stbip,PlotType="InterStructure")
x$InerInter
barplot(x$InerInter)
par(mfrow=c(2,1))
plot(stbip$InterStructure[,1],stbip$InterStructure[,2], xlim=c(0,1.2), asp=1, cex=0.1, col=TableColors)
arrows(0,0, stbip$InterStructure[,1],stbip$InterStructure[,2], col=TableColors)
text(stbip$InterStructure[,1],stbip$InterStructure[,2],labels = x$TableLabels, pos=4, col=TableColors)
barplot(x$InerInter)
par(mfrow=c(1,1))
source('~/Library/Mobile Documents/com~apple~CloudDocs/# # 0 ProgramasR/0 Paquetes/MultBiplotR/R/plot.StatisBiplot.R')
plot(stbip,PlotType="InterStructure")
source('~/Library/Mobile Documents/com~apple~CloudDocs/# # 0 ProgramasR/0 Paquetes/MultBiplotR/R/plot.StatisBiplot.R')
plot(stbip,PlotType="InterStructure")
source('~/Library/Mobile Documents/com~apple~CloudDocs/# # 0 ProgramasR/0 Paquetes/MultBiplotR/R/plot.StatisBiplot.R')
plot(stbip,PlotType="InterStructure")
source('~/Library/Mobile Documents/com~apple~CloudDocs/# # 0 ProgramasR/0 Paquetes/MultBiplotR/R/plot.StatisBiplot.R')
plot(stbip,PlotType="InterStructure")
library(MultBiplotR)
library(MultBiplotR)
library(MultBiplotR)
library(MultBiplotR)
help("CanonicalStatisBiplot")
library(MultBiplotR)
library(MultBiplotR)
x= Chemical[9:14]
X=Convert2ThreeWay(x, groups=Chemical$WEEKS)
Groups=Chemical$Treatment[1:36]
canstbip=CanonicalStatisBiplot(X, Groups, SameVar = TRUE)
plot(canstbip, mode="a", PlotVars=TRUE, ShowBox=TRUE)
plot(canstbip, mode="a", PlotVars=TRUE,PlotRowTraj = F, LabelInd=T, LabelTraj='Begining',PlotVarTraj=T, RowColors=1:12)
library(MultBiplotR)
PlotTrajectory
library(MultBiplotR)
plot(canstbip, mode="a", PlotVars=TRUE,PlotRowTraj = F, LabelInd=T, LabelTraj='Begining',PlotVarTraj=T, RowColors=1:12)
trajvar
source('~/Library/Mobile Documents/com~apple~CloudDocs/# # 0 ProgramasR/0 Paquetes/MultBiplotR/R/CanonicalStatisBiplot.R')
trajvar
x= Chemical[9:14]
X=Convert2ThreeWay(x, groups=Chemical$WEEKS)
Groups=Chemical$Treatment[1:36]
canstbip=CanonicalStatisBiplot(X, Groups, SameVar = TRUE)
source('~/Library/Mobile Documents/com~apple~CloudDocs/# # 0 ProgramasR/0 Paquetes/MultBiplotR/R/CanonicalStatisBiplot.R')
