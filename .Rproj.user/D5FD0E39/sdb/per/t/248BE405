{
    "collab_server" : "",
    "contents" : "SMACOF <- function(P, X=NULL, W=NULL, Model=c(\"Identity\", \"Ratio\", \"Interval\", \"Ordinal\"), dimsol=2, maxiter=100, maxerror=0.000001, StandardizeDisparities=TRUE, ShowIter=FALSE){\n  if (length(Model)>1) Model=Model[1]\n  n <- dim(P)[1]\n  if (is.null(W)) W = matrix(1,n,n)\n  W=W-diag(diag(W))\n  V=-1*W+diag(apply(W,2,sum))\n  W=as.dist(W)\n  # Initial solution (Principal coordinates)\n  if (is.null(X)){\n  b <- -0.5 * (diag(n) - matrix(1, n, n)/n) %*% P^2 %*% (diag(n) - matrix(1, n, n)/n)\n  solut <- svd(b)\n  X <- solut$u %*% diag(sqrt(solut$d))\n  X=X[,1:dimsol]\n  }\n  k=0\n\n  Z=X \n\n  D=as.dist(EuclideanDistance(X))\n  Dh=Dhats(P,D,W,Model, Standardize=StandardizeDisparities)\n  stress=sum(((D-Dh)^2)*W)\n  error=1\n  while ((k <= maxiter) & (error > maxerror)) {\n    k=k+1\n    BZ=as.matrix(-1*W*Dh/D)\n    BZ[which(is.na(BZ))]<-0\n    bzii=-1*apply(BZ,2,sum)\n    BZ=BZ+diag(bzii)\n    X=ginv(V)%*%BZ%*%Z\n    Z=X\n    D=as.dist(EuclideanDistance(Z))\n    Dh=Dhats(P,D,W,Model, Standardize=StandardizeDisparities)\n    newstress=sum(((D-Dh)^2)*W)\n    error = abs(stress-newstress)\n    if (ShowIter) print(c(k, error))\n    stress=newstress\n  }\n\n  scresid=sum((((D-Dh)^2)*W))\n  scdis=sum((((D)^2)*W))\n  dmean=sum(D*W)/sum(W)\n  scdesv=sum(((D-dmean)^2)*W)\n\n  stress1=sqrt(scresid/scdis)\n  stress2=sqrt(scresid/scdesv)\n  sstress1=sqrt(sum(((D^2-Dh^2)^2)*W)/sum(((D^2)^2)*W))\n  dmean2=sum((D^2)*W)/sum(W)\n  sstress2=sqrt(sum(((D^2-Dh^2)^2)*W)/sum(((D^2-dmean2)^2)*W))\n  rsq=cor(Dh*W,D*W)^2\n  rho=cor(Dh*W,D*W,method=\"spearman\")\n  tau=cor(Dh*W,D*W,method=\"kendall\")\n  res=list(X=X,D=D,Dh=Dh,stress=stress, stress1=stress1, stress2=stress2, sstress1=sstress1, sstress2=sstress2, rsq=rsq, rho=rho, tau =tau )\n  class(res)=\"SMACOF\"\n  return(res)\n}\n\n",
    "created" : 1446678628170.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "138522163",
    "id" : "248BE405",
    "lastKnownWriteTime" : 1415788128,
    "last_content_update" : 0,
    "path" : "~/Dropbox/0 ProgramasR/Paquetes/MultBiplotR/R/SMACOF.R",
    "project_path" : "R/SMACOF.R",
    "properties" : {
    },
    "relative_order" : 0,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}