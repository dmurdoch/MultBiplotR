{
    "contents" : "PLSRfit <- function(Y, X, S=2, center=TRUE, scale=TRUE, tolerance=0.000005, maxiter=100, show=FALSE){\n  result=list()\n  I1=dim(X)[1]\n  J=dim(X)[2]\n  I2=dim(Y)[1]\n  K=dim(Y)[2]\n  inames=rownames(X)\n  ynames=colnames(Y)\n  xnames=colnames(X)\n  dimnames=paste(\"Component\", 1:S)\n  result$Method=\"PLSR1\"\n  result$X=X\n  result$Y=Y\n  result$center=center\n  result$scale=scale\n  \n  if (!(I1==I2)) stop('The number of rows of both matrices must be the same')\n  else I=I1\n  \n  if (center & !scale){\n    X=TransformIni(X,transform=4)\n    Y=TransformIni(Y,transform=4)\n    result$Initial_Transformation=4\n  }\n  if (center & scale){\n    X=TransformIni(X,transform=5)\n    Y=TransformIni(Y,transform=5)\n    result$Initial_Transformation=5\n  }\n  \n  result$ScaledX=X\n  result$ScaledY=Y\n  uini=svd(X)\n  T=matrix(0, I, S)\n  rownames(T)=inames\n  colnames(T)=dimnames\n  U=matrix(0, I, S)\n  rownames(U)=inames\n  colnames(U)=dimnames\n  W=matrix(0, J, S)\n  rownames(W)=xnames\n  colnames(W)=dimnames\n  C=matrix(0, K, S)\n  rownames(C)=ynames\n  colnames(C)=dimnames\n  P=matrix(0, J, S)\n  Q=matrix(0, K, S)\n  \n  for (i in 1:S){\n    error=1\n    iter=0\n    u=matrix(uini$u[,i],I,1)\n    while ((error>tolerance) & (iter<maxiter)){\n      iter=iter+1\n      w=(t(X) %*% u)/sum(u^2)\n      w=w/sqrt(sum(w^2))\n      t=X %*% w\n      c=t(Y) %*% t/ sum(t^2)\n      newu= Y %*% c\n      error=sum((u-newu)^2)\n      u=newu\n      if (show) print(c(i, iter, error))\n    }\n    T[,i]=t\n    U[,i]=u\n    W[,i]=w\n    C[,i]=c\n    p=t(X) %*% t/ sum(t^2)\n    P[,i]=p\n    q=t(Y) %*% u/ sum(u^2)\n    Q[,i]=q\n    X=X-t %*% t(p)\n  }\n  \n  rownames(P)=xnames\n  colnames(P)=dimnames\n  rownames(Q)=ynames\n  colnames(Q)=dimnames\n  \n  result$XScores=T\n  result$XWeights=W\n  result$XLoadings=P\n  result$YScores=U\n  result$YWeights=C\n  result$YLoadings=Q\n  result$XStructure=cor(result$X,T)\n  result$YStructure=cor(result$Y,U)\n  result$YXStructure=cor(result$Y,T)\n  class(result)=\"PLSR\"\n  return(result)\n}\n",
    "created" : 1447433679996.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3170316518",
    "id" : "1772916E",
    "lastKnownWriteTime" : 1447433714,
    "path" : "~/Dropbox/0 ProgramasR/Paquetes/MultBiplot/R/PLSRfit.R",
    "project_path" : "R/PLSRfit.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 5,
    "source_on_save" : false,
    "type" : "r_source"
}