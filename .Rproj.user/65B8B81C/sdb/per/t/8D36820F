{
    "collab_server" : "",
    "contents" : "# Autor: Jose Luis Vicente Villardon\n# Dpto. de Estadistica\n# Universidad de Salamanca\n# Revisado: Noviembre/2016\n\nplot.Principal.Coordinates <- function(x, A1 = 1, A2 = 2, LabelRows=TRUE, WhatRows = NULL, RowCex=1, RowPch=16, \n                                       RowLabels = NULL, RowColors = NULL, ColColors=NULL, ColLabels=NULL, SizeQualInd = FALSE, SmartLabels = TRUE, \n                                       ColorQualInd = FALSE, ColorQual=\"black\", PlotSup=TRUE, Bootstrap=FALSE, \n                                       BootstrapPlot=c(\"Ellipse\", \"CovexHull\", \"Star\"),\n                                       PlotClus = FALSE, TypeClus = \"ch\", ClustConf = 1, CexClustCenters=1,\n                                       ClustCenters = FALSE, UseClusterColors = TRUE, ShowAxis=FALSE, PlotBinaryMeans=FALSE,\n                                       MinIncidence=0, ShowBox=FALSE, ...){\n  \n  if (is.null(ColColors)) \n    ColorVar = \"black\"\n  if (is.null(ColLabels)) \n    ColLabels=colnames(x$Data)\n  \n  if (length(BootstrapPlot)>1) BootstrapPlot = BootstrapPlot[1]\n  \n  if (ShowAxis) {\n    xaxt = \"s\"\n    yaxt = \"s\"\n  } else {\n    xaxt = \"n\"\n    yaxt = \"n\"\n  }\n  \n  a = x$RowCoordinates[,c(A1,A2)]\n  n = dim(a)[1]\n  if (is.null(WhatRows)) WhatRows = matrix(1, n, 1)\n  if (is.null(RowColors)) RowColors = matrix(1, n, 1)\n  if (is.null(RowLabels)) RowLabels =rownames(a)\n  \n  #op=par(mai=c(0,0,0.5,0))\n  #op=par(mar=c(1, 1, 1, 1) + 0.1)\n  \n  xmin = min(a[, 1])\n  xmax = max(a[, 1])\n  ymin = min(a[, 2])\n  ymax = max(a[, 2])\n  xrang=abs(xmax-xmin)\n  yrang=abs(ymax-ymin)\n \n  if (x$Analysis == \"Principal Coordinates\"){\n  xlab=paste(\"(Dim\", A1,\"(\",round(x$Inertia[A1], digits=1),\"%)\")\n  ylab=paste(\"(Dim\",A2,\"(\",round(x$Inertia[A2], digits=1),\"%)\")}\n  else{\n    xlab=paste(\"Dim\", A1)\n    ylab=paste(\"Dim\", A2)\n  }\n  \n  plot(a[, 1], a[, 2], cex = 0, asp = 1,  xaxt = xaxt, yaxt = yaxt, xlab=xlab,ylab=ylab, bty=\"n\", ...)\n  \n  if (x$Analysis == \"Principal Coordinates\"){\n    title(main = \"Principal Coordinates\", omi = c(0, 0, 0, 0))}\n  else{\n    title(main = \"MDS\", omi = c(0, 0, 0, 0))\n  }\n  \n  if (ShowBox) rect(xmin, ymin, xmax, ymax)\n  \n  if (PlotClus) {\n    RowColors=PlotBiplotClusters(a, x$Clusters, TypeClus = TypeClus, ClusterColors = x$ClusterColors, ClusterNames=x$ClusterNames, centers = ClustCenters, ClustConf=ClustConf, CexClustCenters=CexClustCenters, ...)\n    if (x$ClusterType==\"gm\"){\n      ColorInd2=rgb((x$P %*% t(col2rgb(x$ClusterColors)))/255)\n      if (UseClusterColors) RowColors = ColorInd2\n      PchInd=rep(16,n)\n    }\n  }\n\n  qlrrows = x$RowQualities[, A1] + x$RowQualities[, A2]\n  if (ColorQualInd==TRUE) RowColors = cscale(qlrrows, seq_gradient_pal(\"white\", ColorQual))\n  \n  neje = dim(a)[2]\n  points(a[, 1], a[, 2], col = RowColors, cex=WhatRows*RowCex, pch=RowPch, asp=1, ...)\n  \n  if (LabelRows)  \n      if (SmartLabels) \n        textsmart(cbind(a[, 1], a[, 2]), RowLabels, CexPoints = WhatRows*RowCex, ColorPoints = RowColors)\n  else text(a[, 1], a[, 2], labels = RowLabels, cex=WhatRows*RowCex , col = RowColors)\n  \n  if ((PlotBinaryMeans) & (x$TypeData==\"Binary\") &(!is.null(x$Data))){\n    tot=apply(x$Data, 2, sum)\n    cc= diag(1/tot) %*% t(x$Data) %*% a\n    cc=cc[which(tot>MinIncidence),]\n    rownames(cc)=ColLabels[which(tot>MinIncidence)]\n    points(cc[, 1], cc[, 2], col = ColColors, pch=16)\n    textsmart(cbind(cc[, 1], cc[, 2]), ColorPoints=ColColors, colnames(x$Data), CexPoints=0.7)\n  }\n  \n  if((PlotSup) & !is.null(x$SupRowCoordinates)){\n    b = x$SupRowCoordinates[,c(A1,A2)]\n    points(b[, 1], b[, 2], col = 2)\n    if (LabelRows)  \n      if (SmartLabels) \n        textsmart(cbind(b[, 1], b[, 2]), CexPoints = 1, ColorPoints = 2)\n    else text(b[, 1], b[, 2],labels=rownames(b), col = 2)\n  }\n\n  if ((Bootstrap==TRUE) & (!is.null(x$BootstrapInfo)))\n  plot.PCoABootstrap(x$BootstrapInfo, BootstrapPlot=BootstrapPlot , confidence=0.95, Colors=RowColors)\n  # par(op)\n}\n",
    "created" : 1480321862993.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2734043136",
    "id" : "8D36820F",
    "lastKnownWriteTime" : 1480342701,
    "last_content_update" : 1480342701,
    "path" : "~/Dropbox/0 ProgramasR/Paquetes/MultBiplotR/R/plot.Principal.Coordinates.R",
    "project_path" : "R/plot.Principal.Coordinates.R",
    "properties" : {
    },
    "relative_order" : 8,
    "source_on_save" : true,
    "source_window" : "",
    "type" : "r_source"
}