{
    "collab_server" : "",
    "contents" : "data(Protein)\nstr(Protein)\n\n\n# PRINCIPAL COMPONENTES\n\n# With Base Statistics\n# centering is done by default\nProt.prcomp==prcomp(Protein[,3:11])\nsummary(Prot.prcomp)\nattributes(Prot.prcomp)\nvariance=(Prot.prcomp$sdev)^2\nInercia=variance/sum(variance)\nCumInercia=cumsum(Inercia)\n# In rotation, the eigenvectors are given\napply(Prot.prcomp$rotation^2, 2, sum)\nplot(Prot.prcomp)\nbiplot(Prot.prcomp)\n\n# Con la funcion prcomp\nProt.prcomp=prcomp(Protein[,3:11], scale = TRUE)\nsummary(Prot.prcomp)\nattributes(Prot.prcomp)\nvariance=(Prot.prcomp$sdev)^2\nInercia=variance/sum(variance)\nCumInercia=cumsum(Inercia)\n# In rotation, the eigenvectors are given\napply(Prot.prcomp$rotation^2, 2, sum)\nplot(Prot.prcomp)\nbiplot(Prot.prcomp)\n\n# Con la funcion princomp\nProt.princomp=princomp(Protein[,3:11], cor = TRUE)\nsummary(Prot.princomp)\nattributes(Prot.princomp)\nvariance2=(Prot.princomp$sdev)^2\nInercia2=100*variance2/sum(variance2)\nCumInercia2=cumsum(Inercia2)\n# In rotation, the eigenvectors are given\napply(Prot.princomp$loadings^2, 2, sum)\nloads=Prot.princomp$loadings %*% diag(Prot.princomp$sdev)\napply(loads^2, 2, sum)\nplot(Prot.princomp)\nbiplot(Prot.princomp)\n\ninstall.packages(\"psych\")\nlibrary(psych)\n\n# An example of the confusion between Principal Components and Factor Analysis\n# Principal Components Analysis and factor Analysis are distinct methods\n# PC can be used as a solution to the factor problem, but there are many others\nProt.principal=principal(Protein[,3:11], nfactors=2, rotate=\"none\")\nProt.principal\nsummary(Prot.principal)\n\n\n# Factominer is a package for explorartory multivariate analysis\ninstall.packages(\"FactoMineR\")\nlibrary(FactoMineR)\nhelp(PCA)\nhelp(plot.PCA)\nProt.PCA=PCA(Protein[,3:11])\nprint(Prot.PCA)\nsummary(Prot.PCA)\nplot.PCA(Prot.PCA, choix=\"ind\")\nplot.PCA(Prot.PCA, choix=\"var\")\nplot.PCA(Prot.PCA, choix=\"varcor\")\nbiplot(Prot.PCA)\n\ninstall.packages(\"ade4\")\ninstall.packages(\"adegraphics\")\nlibrary(ade4)\nlibrary(adegraphics)\nhelp(dudi.pca)\nProt.dudi.pca=dudi.pca(Protein[,3:11], nf=3)\nProt.dudi.pca\nsummary(Prot.dudi.pca)\ns.class(Prot.dudi.pca$li, Protein$Region, cpoint = 1)\ns.arrow(Prot.dudi.pca$c1, lab = names(Protein))\ns.corcircle(Prot.dudi.pca$co, lab = names(Protein), full = FALSE)\n\n\ninstall.packages(\"amap\")\nlibrary(amap)\nProt.acp=acp(Protein[,3:11])\nProt.acp\nsummary(Prot.acp)\nplot(Prot.acp)\n\n\n\ninstall.packages(c(\"scales\", \"geometry\", \"deldir\", \"rgl\", \"mirt\", \"GPARotation\", \"MASS\", \"kde2d\", \"lattice\", \"splom\", \"dae\"))\ninstall.packages(\"http://biplot.usal.es/classicalbiplot/multbiplot-in-r/multbiplotr_0331tar.gz\", repos = NULL, type=\"source\")\nlibrary(MultBiplotR)\nhelp(\"PCA.Biplot\")\nProt.PCA.Biplot=PCA.Biplot(Protein[,3:11])\nsummary(Prot.PCA.Biplot)\nhelp(\"plot.ContinuousBiplot\")\nplot(Prot.PCA.Biplot, PlotVars=F, ShowBox=T)\nplot(Prot.PCA.Biplot, PlotVars=F, ShowBox=T, SizeQualInd=T)\nplot(Prot.PCA.Biplot, PlotVars=F, ShowBox=T, ColorQualInd = T)\nplot(Prot.PCA.Biplot, PlotVars=F, ShowBox=F, SizeQualInd=T, ColorQualInd = T, ShowAxis=T)\nhelp(AddCluster2Biplot)\nProt.PCA.Biplot=AddCluster2Biplot(Prot.PCA.Biplot, ClusterType=\"us\", Groups=Protein$Region)\nplot(Prot.PCA.Biplot, PlotVars=F, PlotClus=T, ClustCenters=T, TypeClus = \"el\")\n\nProt.PCA.Biplot=AddCluster2Biplot(Prot.PCA.Biplot, ClusterType=\"hi\" , method=\"ward.D\")\nplot(Prot.PCA.Biplot, PlotVars=F, PlotClus=T, ClustCenters=T, TypeClus = \"st\")\n\nProt.PCA.Biplot=AddCluster2Biplot(Prot.PCA.Biplot, ClusterType=\"hi\" , method=\"ward.D\", Original=T)\nplot(Prot.PCA.Biplot, PlotVars=F, PlotClus=T, ClustCenters=T, TypeClus = \"st\")\nplot(Prot.PCA.Biplot, PlotVars=T, PlotClus=T, ClustCenters=T, TypeClus = \"ch\")\nplot(Prot.PCA.Biplot, PlotVars=T, PlotClus=T, ClustCenters=T, TypeClus = \"st\", mode=\"s\", margin=0.05)\nplot3d.ContinuousBiplot(Prot.PCA.Biplot)\n\n# EXPLORATORY FACTOR ANALYSIS\n\n# Maximum Likelihood\nhelp(factanal)\nProt.factanal = factanal(Protein[,3:11], 3, rotation=\"varimax\", scores=\"regression\")\nprint(Prot.factanal, digits=2, cutoff=.3, sort=TRUE)\nplot(Prot.factanal)\n# plot factor 1 by factor 2\nload <- Prot.factanal$loadings[,1:2]\nplot(load,type=\"n\") # set up plot\ntext(load,labels=names(Protein[,3:11]),cex=.7) # add variable names\n\nProt.factanal = factanal(Protein[,3:11], 3, rotation=\"varimax\", scores=\"regression\")\nProt.factanal$scores\nprint(Prot.factanal, digits=2, cutoff=.3, sort=TRUE)\n\nlibrary(psych)\nhelp(factor.pa)\nProt.fa <- fa(Protein[,3:11], nfactors=3, fm=\"pa\", rotate=\"varimax\")\nProt.fa # print results\n\nlibrary(MultBiplotR)\nhelp(FA.Biplot)\nProt.FA.Biplot=FA.Biplot(Protein[,3:11], Rotation=\"varimax\", Scores=\"Regression\", Extraction=\"IPF\")\nProt.FA.Biplot\nsummary(Prot.FA.Biplot)\nScreePlot(Prot.FA.Biplot)\nplot(Prot.FA.Biplot)\nCorrelationCircle(Prot.FA.Biplot)\n\n# DISCRIMINANT ANALYSIS\nlibrary(MASS)\nProt.lda=lda(Protein[,3:11], grouping=Protein$Comunist, CV=F)\nProt.lda\nnames(Prot.lda)\nct <- table(Protein$Comunist, Prot.lda$class)\nsum(diag(prop.table(ct)))\nplot(Prot.lda)\nplot(Prot.lda, dimen=1, type=\"both\")\n\nProt.lda=lda(Protein[,3:11], grouping=Protein$Region, CV=F)\nnames(Prot.lda)\nct <- table(Protein$Region, Prot.lda$class)\nsum(diag(prop.table(ct)))\nplot(Prot.lda)\n\nplot(Prot.lda, dimen=1, type=\"both\")\n\n\nlibrary(DiscriMiner)\nhelp(desDA)\nprot.linda = desDA(Protein[,3:11], Protein$Region)\nnames(prot.linda) \nprot.linda\n\n\n\nlibrary(MultBiplotR)\nProt.canbip=CanonicalBiplot(Protein[,3:11], group=Protein$Region, LDA=TRUE, MANOVA=TRUE)\nsummary(Prot.canbip)\nnames(Prot.canbip)\nplot(Prot.canbip, ShowBox=F, TypeCircle = \"C\", PlotVars=F, AddLegend=F)\nProt.canbip$LDA\nProt.canbip$ClassificationTable\nProt.canbip$PercentCorrect\nProt.canbip$TotalPercentCorrect\n\n",
    "created" : 1479479243778.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1515083573",
    "id" : "AD44F399",
    "lastKnownWriteTime" : 1479731451,
    "last_content_update" : 1479731451,
    "path" : "~/Dropbox/0 ProgramasR/PracticaMultivarR.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 12,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}